1                                                          The SAS System                            09:44 Saturday, August 13, 2016

NOTE: Copyright (c) 2002-2012 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M3 MBCS3170) 
      Licensed to Van der Vorst Arnaud-E33271, Site 70068118.
NOTE: This session is executing on the Linux 3.10.0-327.22.2.el7.x86_64 (LIN X64) platform.



NOTE: Updated analytical products:
      
      SAS/STAT 14.1
      SAS/ETS 14.1
      SAS/OR 14.1
      SAS/IML 14.1
      SAS/QC 14.1

NOTE: Additional host information:

 Linux LIN X64 3.10.0-327.22.2.el7.x86_64 #1 SMP Thu Jun 23 17:05:11 UTC 2016 x86_64 CentOS Linux release 7.2.1511 (Core)  

You are running SAS 9. Some SAS 8 files will be automatically converted 
by the V9 engine; others are incompatible.  Please see 
http://support.sas.com/rnd/migration/planning/platform/64bit.html

PROC MIGRATE will preserve current SAS file attributes and is 
recommended for converting all your SAS libraries from any 
SAS 8 release to SAS 9.  For details and examples, please see
http://support.sas.com/rnd/migration/index.html


This message is contained in the SAS news file, and is presented upon
initialization.  Edit the file "news" in the "misc/base" directory to
display site-specific news and information in the program log.
The command line option "-nonews" will prevent this display.




NOTE: SAS initialization used:
      real time           0.06 seconds
      cpu time            0.03 seconds
      
1          *;
2          libname insaslib "/tmp/viya/" access=readonly;
NOTE: Libref INSASLIB was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /tmp/viya
3          libname ousaslib "/tmp/v94/";
NOTE: Libref OUSASLIB was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /tmp/v94
4          *;
5          
6          /* Define some 'global' macro variables. */
7          
8          /* Input data set (e.g. ousaslib.skp1walsplusKeys) */
9          *%let inputdsn=ousaslib.skp1small;
10         *%let inputdsn=ousaslib.skp1walsplusKeys;
11         %let inputdsn=ousaslib.crm3allplusKeys;
2                                                          The SAS System                            09:44 Saturday, August 13, 2016

12         
13         /* Key columns in inputdsn: BY variables for PROC EXPAND, PROC TRANSREG ... */
14         %let KeyCols=cl_n bew_vn dch_n; *_deel;
15         *%let KeyCols=cl_n bew_vn dch_n;
16         /* time ID in inputdsn for PROC EXPAND, PROC TRANSREG ... */
17         %let t=ts_registratie;
18         /* TARGET column */
19         %let target=d524;
20         /* ID columns AND TARGET variable in inputdsn: these are not treated as ordinary interval variables here. */
21         %let IDCols=("ts_registratie", "cl_n", "bew_vn", "dch_n", "ts_be", "ts_ei", "&target.");
22         
23         /*proc format;
24         	value missfmt . ='Missing' other='Not Missing';
25         run;*/
26         
27         *data ousaslib.skp1small;
28         	*set ousaslib.skp1walsplusKeys(obs=2000);
29         	*keep cl_n bew_vn dch_n ts_registratie d324 d382 d522 d523 d524 _deel _x _pol KeyCol;
30         	*KeyCol = catx("_", cl_n, put(bew_vn,best.), put(dch_n,best.), put(_deel,best.));
31         *run;
32         
33         /* Preprocess the signal y in a pass- or coil-based data set dsn (e.g. ousaslib.skp1walsplusKeys).
34            A smoothed version P_y of the signal y is added to this data set dsn on return. */
35         %macro preprocess(dsn=, y=, KeyCol=);
36         	/* 1. Remove outliers. */
37         	proc univariate data=&dsn. noprint;
38         		by &KeyCol.;
39         		var &y.;
40         		output out=work.tmp q1=q1 q3=q3 qrange=iqr;
41         	run;
42         	data work.out;
43         		merge &dsn. work.tmp;
44         		by &KeyCol.;
45         		if ((&y.<q1-1.5*iqr) or (&y.>q3+1.5*iqr)) then &y.=.;	
46         	run;
47         	
48         	/* 2. Apply moving average filter. */
49         	proc expand data=work.out out=work.avg method=none;
50         		by &KeyCol.;
51         		id &t.;
52         		convert &y. = &y.f / transformout=(movave 3);
53         	run;
54         	proc datasets library=work nolist;
55          		delete tmp out / memtype=data;
56          	run;
57         
58         	/* 3. Remove outliers again, but now based on stddev. */
59         	data work.avg;
60         		set work.avg; /* contains &y.f now */
61         		_delta_&y. = &y. - &y.f; /* NOTE: Missing values were generated as a result of performing an operation on missing
61       ! values (in &y.). */
62         	run;
63         	proc univariate data=work.avg noprint;
64         		by &KeyCol.;
65         		var _delta_&y.;
66         		output out=work.tmp std=stddev;
67         	run;
68         	data work.out;
3                                                          The SAS System                            09:44 Saturday, August 13, 2016

69         		merge work.avg work.tmp;
70         		by &KeyCol.;
71         		if (abs(&y. - &y.f) > 2*stddev) then &y.=.;
72         		drop _delta_&y. &y.f;
73         	run;
74         	proc datasets library=work nolist;
75          		delete tmp avg / memtype=data;
76          	run;
77         	
78         	/* 4. Fit a cubic spline. */
79         	/* First, handle missing values */
80         	proc expand data=work.out out=work.full method=spline;
81         		by &KeyCol.;
82         		id &t.;
83         		convert &y. = &y.f; /* WARNING: The variable d025 has only 0 nonmissing observations, which is too few to apply the
83       ! conversion method. The result series
84                   is set to missing. */
85         	run;
86         	/*proc freq data=work.full;
87         		by &KeyCol.;
88         		format _numeric_ missfmt.;
89         		tables &y. &y.f / missing missprint nocum nopercent;
90         	run;*/
91         
92         /*  For INPUT variables */
93         	data &dsn.;
94         		merge &dsn. work.full(keep=&KeyCol. &t. &y.f rename=(&y.f=P_&y.));
95         		by &KeyCol. &t.;
96         	run;
97         
98         /*  For TARGET variable */
99         /*	options nonotes;
100        	proc transreg data=work.full noprint plots=none;
101        		by &KeyCol.;
102        		model identity(&y.f) = spline(&t. / degree=3);
103        		output out=work.spline predicted;
104        	run;
105        	options notes;
106        	data &dsn.;
107        		merge &dsn. work.spline(drop=_TYPE_ _NAME_ &y.f T&y.f Intercept TIntercept	T&t. rename=(P&y.f=P_&y.));
108        		by &KeyCol. &t.;
109        		if (P_&y.=0) then P_&y.=&y.;
110        	run; */
111        	proc datasets library=work nolist;
112         		delete out full /*spline*/ / memtype=data;
113         	run;
114        	quit;
115        %mend;
116        /* end of macro */
117        
118        /* Preprocess all interval variables in a pass- or coil-based data set. */
119        %macro preprocess_all();
120        
121        	proc sort data=&inputdsn.;
122        		by &KeyCols. &t.;
123        	run;
124        
125        	/* Determine interval variables. */
4                                                          The SAS System                            09:44 Saturday, August 13, 2016

126        	%include '/home/sastest/sbxviya/sasuser.viya/srclib/SAS94M3/0041DetermineIntColumns.sas';
127        	%put &=intlist.; /* interval variables */
128        
129        	%let nvar=%sysfunc(countw(&intlist.,%str( )));
130        	
131        	%do ivar=1 %to &nvar.;
132        		%let yvar=%scan(&intlist.,&ivar.);
133        		%preprocess(dsn=&inputdsn., y=&yvar., KeyCol=&KeyCols.);
134        	%end;
135        
136        %mend;
137        /* end of macro */
138        
139        *options source2;
140        
141        /* For INPUT variables */
142        %preprocess_all();

ERROR: No disk space is available for the write operation.  Filename = /tmp/SAS_util0001000036F8_sbxintern16/ut36F8000002.utl.
ERROR: Failure while attempting to write page 248 of sorted run 21.
ERROR: Failure while attempting to write page 163908 to utility file 1.
ERROR: Failure encountered while creating initial set of sorted runs.
ERROR: Failure encountered during external sort.
ERROR: Sort execution failure.
NOTE: The SAS System stopped processing this step because of errors.
NOTE: SAS set option OBS=0 and will continue to check statements. This might cause NOTE: No observations in data set.
NOTE: There were 7045249 observations read from the data set OUSASLIB.CRM3ALLPLUSKEYS.
WARNING: The data set OUSASLIB.CRM3ALLPLUSKEYS may be incomplete.  When this step was stopped there were 0 observations and 390 
         variables.
WARNING: Data set OUSASLIB.CRM3ALLPLUSKEYS was not replaced because this step was stopped.
NOTE: PROCEDURE SORT used (Total process time):
      real time           10:55.00
      cpu time            1:23.23
      
WARNING: Physical file does not exist, /home/sastest/sbxviya/sasuser.viya/srclib/SAS94M3/0041DetermineIntColumns.sas.
ERROR: Cannot open %INCLUDE file /home/sastest/sbxviya/sasuser.viya/srclib/SAS94M3/0041DetermineIntColumns.sas.
WARNING: Apparent symbolic reference INTLIST not resolved.
intlist.
WARNING: Apparent symbolic reference INTLIST not resolved.
WARNING: Apparent symbolic reference INTLIST not resolved.


ERROR: Variable INTLIST not found.

NOTE: The SAS System stopped processing this step because of errors.
WARNING: The data set WORK.TMP may be incomplete.  When this step was stopped there were 0 observations and 0 variables.
NOTE: PROCEDURE UNIVARIATE used (Total process time):
      real time           5.28 seconds
      cpu time            0.04 seconds
      


NOTE: The data set WORK.OUT has 0 observations and 394 variables.
NOTE: DATA statement used (Total process time):
      real time           3.09 seconds
      cpu time            0.01 seconds
      

5                                                          The SAS System                            09:44 Saturday, August 13, 2016


NOTE: The data set WORK.AVG has 0 observations and 0 variables.
NOTE: PROCEDURE EXPAND used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.44 seconds
      cpu time            0.01 seconds
      


NOTE: The data set WORK.AVG has 0 observations and 3 variables.
WARNING: Data set WORK.AVG was not replaced because this step was stopped.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

ERROR: Variable CL_N not found.
ERROR: Variable BEW_VN not found.
ERROR: Variable DCH_N not found.
ERROR: Variable _DELTA_INTLIST not found.

NOTE: The SAS System stopped processing this step because of errors.
WARNING: The data set WORK.TMP may be incomplete.  When this step was stopped there were 0 observations and 0 variables.
WARNING: Data set WORK.TMP was not replaced because this step was stopped.
NOTE: PROCEDURE UNIVARIATE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


WARNING: The variable _delta_intlist in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: The data set WORK.OUT has 0 observations and 2 variables.
WARNING: Data set WORK.OUT was not replaced because this step was stopped.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      



NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


NOTE: The data set WORK.FULL has 0 observations and 0 variables.
NOTE: PROCEDURE EXPAND used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

ERROR: Variable intlistf is not on file WORK.FULL.
ERROR: Invalid DROP, KEEP, or RENAME option on file WORK.FULL.
6                                                          The SAS System                            09:44 Saturday, August 13, 2016


NOTE: The SAS System stopped processing this step because of errors.
WARNING: The data set OUSASLIB.CRM3ALLPLUSKEYS may be incomplete.  When this step was stopped there were 0 observations and 390 
         variables.
WARNING: Data set OUSASLIB.CRM3ALLPLUSKEYS was not replaced because this step was stopped.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

143        
144        /* For TARGET variable */
145        *%preprocess(dsn=&inputdsn., y=&target., KeyCol=&KeyCols.);
146        
147        data $inputdsn._PREP;
ERROR: Libref ''$inputdsn'n' exceeds 8 characters.
148        	set &inputdsn.(drop=&intlist.);
                                _
                                214
                                23
ERROR 214-322: Variable name & is not valid.

ERROR 23-7: Invalid value for the DROP option.

                                 ________
                                 23
148      ! 	set &inputdsn.(drop=&intlist.);
                                 ________
                                 214
WARNING: Apparent symbolic reference INTLIST not resolved.
ERROR 214-322: Variable name intlist. is not valid.

149        run;

NOTE: The SAS System stopped processing this step because of errors.
NOTE: DATA statement used (Total process time):
      real time           0.15 seconds
      cpu time            0.00 seconds
      

150        
151        /* end of program */

ERROR: Errors printed on pages 4,5,6.

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           11:08.80
      cpu time            1:23.36
      
